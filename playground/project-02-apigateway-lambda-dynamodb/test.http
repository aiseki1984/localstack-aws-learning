# ==========================================
# Lambda + API Gateway Posts API ãƒ†ã‚¹ãƒˆ
# ==========================================
# 
# ä½¿ç”¨æ–¹æ³•:
# 1. VS Code ã§ REST Client æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# 2. å„HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã€ŒSend Requestã€ã‚’ã‚¯ãƒªãƒƒã‚¯
# 3. API_IDã¯ scripts/list-resources.sh ã§ç¢ºèªå¯èƒ½
#
# LocalStackç’°å¢ƒã§ã®å‹•ä½œç¢ºèªç”¨
# ==========================================

# è¨­å®šå¤‰æ•°
@api_id = jw2wtnrqtm
@stage = dev
@base_url = http://localstack:4566/restapis/{{api_id}}/{{stage}}/_user_request_

# ==========================================
# ğŸ“– æŠ•ç¨¿ä¸€è¦§å–å¾— (GET /posts)
# ==========================================
# å…¨ã¦ã®æŠ•ç¨¿ã‚’å–å¾—ã—ã¾ã™
# ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: limit, offset, status, author, tag

### åŸºæœ¬çš„ãªæŠ•ç¨¿ä¸€è¦§å–å¾—
GET {{base_url}}/posts

### ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§å–å¾—
GET {{base_url}}/posts?limit=2&offset=0

### å…¬é–‹æ¸ˆã¿ã®æŠ•ç¨¿ã®ã¿å–å¾—
GET {{base_url}}/posts?status=published

### ç‰¹å®šã®ä½œè€…ã§çµã‚Šè¾¼ã¿
GET {{base_url}}/posts?author=John

### ã‚¿ã‚°ã§çµã‚Šè¾¼ã¿
GET {{base_url}}/posts?tag=aws

# ==========================================
# ğŸ” ç‰¹å®šæŠ•ç¨¿å–å¾— (GET /posts/{id})
# ==========================================
# IDã‚’æŒ‡å®šã—ã¦ç‰¹å®šã®æŠ•ç¨¿ã‚’å–å¾—ã—ã¾ã™

### å­˜åœ¨ã™ã‚‹æŠ•ç¨¿ã‚’å–å¾—
GET {{base_url}}/posts/1

### å­˜åœ¨ã—ãªã„æŠ•ç¨¿ã‚’å–å¾—ï¼ˆ404ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆï¼‰
GET {{base_url}}/posts/999

# ==========================================
# âœï¸ æ–°è¦æŠ•ç¨¿ä½œæˆ (POST /posts)
# ==========================================
# æ–°ã—ã„æŠ•ç¨¿ã‚’ä½œæˆã—ã¾ã™

### åŸºæœ¬çš„ãªæŠ•ç¨¿ä½œæˆï¼ˆæœ€å°é™ã®æƒ…å ±ï¼‰
POST {{base_url}}/posts
Content-Type: application/json

{
  "title": "ãƒ†ã‚¹ãƒˆæŠ•ç¨¿",
  "content": "ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆç”¨ã®æŠ•ç¨¿å†…å®¹ã§ã™ã€‚",
  "author": "ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼"
}

### ãƒ•ãƒ«æƒ…å ±ã§ã®æŠ•ç¨¿ä½œæˆ
POST {{base_url}}/posts
Content-Type: application/json

{
  "title": "AWS Lambda + API Gateway å­¦ç¿’è¨˜éŒ²",
  "content": "ä»Šæ—¥ã¯Lambdaã¨API Gatewayã®é€£æºã«ã¤ã„ã¦å­¦ç¿’ã—ã¾ã—ãŸã€‚TypeScriptã§ã®å®Ÿè£…ãŒæ€ã£ãŸã‚ˆã‚Šç°¡å˜ã§ã—ãŸã€‚",
  "author": "Lambdaå­¦ç¿’è€…",
  "tags": ["aws", "lambda", "api-gateway", "typescript"],
  "status": "published"
}

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆï¼ˆå¿…é ˆé …ç›®ãªã—ï¼‰
POST {{base_url}}/posts
Content-Type: application/json

{
  "title": "",
  "content": "å†…å®¹ã¯ã‚ã‚‹ã‘ã©ã‚¿ã‚¤ãƒˆãƒ«ãŒãªã„"
}

# ==========================================
# ğŸ”„ æŠ•ç¨¿æ›´æ–° (PUT /posts/{id})
# ==========================================
# æ—¢å­˜ã®æŠ•ç¨¿ã‚’æ›´æ–°ã—ã¾ã™

### ã‚¿ã‚¤ãƒˆãƒ«ã®ã¿æ›´æ–°
PUT {{base_url}}/posts/1
Content-Type: application/json

{
  "title": "æ›´æ–°ã•ã‚ŒãŸã‚¿ã‚¤ãƒˆãƒ«"
}

### è¤‡æ•°é …ç›®ã‚’æ›´æ–°
PUT {{base_url}}/posts/2
Content-Type: application/json

{
  "title": "å®Œå…¨ã«æ›´æ–°ã•ã‚ŒãŸæŠ•ç¨¿",
  "content": "å†…å®¹ã‚‚æ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚",
  "status": "published",
  "tags": ["updated", "modified"]
}

### å­˜åœ¨ã—ãªã„æŠ•ç¨¿ã®æ›´æ–°ï¼ˆ404ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆï¼‰
PUT {{base_url}}/posts/999
Content-Type: application/json

{
  "title": "å­˜åœ¨ã—ãªã„æŠ•ç¨¿ã®æ›´æ–°"
}

# ==========================================
# ğŸ—‘ï¸ æŠ•ç¨¿å‰Šé™¤ (DELETE /posts/{id})
# ==========================================
# æŠ•ç¨¿ã‚’å‰Šé™¤ã—ã¾ã™

### æŠ•ç¨¿å‰Šé™¤ï¼ˆå®Ÿéš›ã«å‰Šé™¤ã™ã‚‹å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤ï¼‰
# DELETE {{base_url}}/posts/3

### å­˜åœ¨ã—ãªã„æŠ•ç¨¿ã®å‰Šé™¤ï¼ˆ404ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆï¼‰
DELETE {{base_url}}/posts/999

# ==========================================
# ğŸ”§ CORS ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ†ã‚¹ãƒˆ
# ==========================================
# ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®CORSãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ†ã‚¹ãƒˆ

### CORS ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ
OPTIONS {{base_url}}/posts
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Content-Type
Origin: http://localhost:3000

# ==========================================
# ğŸ“Š ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ
# ==========================================

### ä¸æ­£ãªHTTPãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆ405ã‚¨ãƒ©ãƒ¼ï¼‰
PATCH {{base_url}}/posts/1

### å­˜åœ¨ã—ãªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ404ã‚¨ãƒ©ãƒ¼ï¼‰
GET {{base_url}}/invalid-endpoint

### ä¸æ­£ãªJSONï¼ˆ400ã‚¨ãƒ©ãƒ¼ï¼‰
POST {{base_url}}/posts
Content-Type: application/json

{ "invalid": "json", }